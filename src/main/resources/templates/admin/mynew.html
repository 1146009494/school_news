<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:include="include/admin/adminHeader::html('管理员')"></head>


<script type="text/javascript">
    $(function () {
        /*时间格式化*/
        Vue.filter('dateformat', function(dataStr) {
            return moment(dataStr).format('YYYY-MM-DD HH:mm:ss')
        });

        /*文档加载开始*/
        var data4Vue = {
            uri: "new",
            pagination: {},
            beans: [],
            bean: {
                id: 0, user_write: {id:0,realname:""}, refer_time: "", note_type: {id: 0}, note_title: "", note: ""
                , image_url: "", video_url: "", user_auditor: {realname:""},auditor_time:"", state: "审核通过"
            },
            keyword: "",
            is_search: "",
            video_url:""
        };


        //ViewModel
        var vue = new Vue({
            el: '#workingArea',
            data: data4Vue,
            mounted: function () { //mounted　表示这个 Vue 对象加载成功了
                this.getUser();
                this.list(0);
            },
            methods: {
                getUser:function () {
                    this.bean.user_write.id=parseInt([[${session.user.id}]]);
                },
                list: function (start) {
                    alert(1);
                    var url=this.uri+"?user_write_id="+this.bean.user_write.id;
                    axios.get(url).then(function (response) {
                        console.log(response.data);
                        vue.pagination = response.data.data;
                        vue.beans = response.data.data.content;

                    });
                },
                search: function () {
                    this.is_search = true;
                    var url = this.uri + "_search/"+this.bean.state+"?keyword=" + this.keyword;
                    axios.get(url).then(function (response) {
                        vue.pagination = response.data.data;
                        vue.beans = response.data.data.content;
                    })
                },
                all: function () {
                    this.is_search = false;
                    this.list(0);
                },
                getVideoUrl:function (video_url) {
                    this.video_url=video_url;
                },
                jump: function (page) {
                    jump(page, vue); //定义在adminHeader.html 中
                },
                jumpByNumber: function (start) {
                    jumpByNumber(start, vue);
                }
            }
        });

        /*文档加载借宿*/
    });


</script>

<body>
<div>
    <div id="workingArea">
        <div class="container">
            <div class="row">
                <!--栅栏布局12列开始-->
                <div class="col-xs-12"><p>欢迎进入校园管理系统后台</p></div>

                <!--栅栏布局3列-->
                <div th:replace="include/admin/adminLeftMenu::html"></div>



                <!--栅栏布局9列开始-->
                <div class="col-xs-9 ">

                    <!--搜索框开始-->
                    <!--<div class="container">-->
                    <div class="input-group">
                        <input type="text" v-model="keyword" class="form-control input-md">
                        <span @click="search" class="input-group-addon btn btn-primary">搜索</span>
                        <span @click="all" class="input-group-addon btn btn-primary" th:text="显示全部"></span>
                    </div>
                    <!--</div>-->
                    <!--搜索框结束-->

                    <!--查询结果显示开始-->
                    <div>
                        <span class="text-muted">发布列表</span>
                        <table class="table table-striped table-bordered table-hover  table-condensed">
                            <thead>
                            <tr class="success">
                                <th>ID</th>
                                <th>作者</th>
                                <th>提交时间</th>
                                <th>文章标题</th>
                                <th>文章内容</th>
                                <th>文章类型</th>
                                <th>相关图片</th>
                                <th>相关视频</th>
                                <th>审核人</th>
                                <th>审核时间</th>
                                <!--<th>删除</th>-->
                                <!--<th>编辑</th>-->
                            </tr>
                            </thead>
                            <tbody>
                            <tr v-for=" bean in beans">
                                <td>{{bean.id}}</td>
                                <td>{{bean.user_write.realname}}</td>
                                <td>{{bean.refer_time|dateformat}}</td>
                                <!--<td><div id="dates" class="format">{{bean.refer_time}}</div></td>-->
                                <td>{{bean.note_title}}</td>
                                <td>{{bean.note}}</td>
                                <td>{{bean.note_type.name}}</td>
                                <td><img height="50px" :src="'img/news/'+bean.image_url"></td>
                                <td>
                                    <a href="#nowhere" @click="getVideoUrl(bean.video_url)" data-toggle="modal" data-target="#myModal">
                                        <span class="glyphicon glyphicon-list"></span></a>
                                </td>
                                <td>{{bean.user_read.realname}}</td>
                                <td>{{bean.auditor_time|dateformat}}</td>
                                <!--<td><a href="#nowhere" @click="deleteBean(bean.id)">-->
                                <!--<span class="glyphicon glyphicon-trash"></span></a></td>-->
                                <!--<td><a href="#nowhere" @click="getBean(bean.id)" data-toggle="modal" data-target="#myModal">-->
                                <!--<span class="glyphicon glyphicon-edit"></span></a>-->
                                <!--</td>-->
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <!--查询结果显示结束-->

                    <!--分页显示-->
                    <div th:replace="include/admin/adminPage::html"></div>

                    <!--<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">-->
                        <!--<div class="modal-dialog">-->
                            <!--<div class="modal-content">-->
                                <!--<div class="modal-header">-->
                                    <!--<button data-dismiss="modal" class="close" type="button"><span aria-hidden="true">×</span><span-->
                                            <!--class="sr-only">Close</span></button>-->
                                    <!--<h4 class="modal-title" >{{video_url}}</h4>-->
                                    <!--<video height="600px" width="600px" :src="'video/news/'+video_url" controls preload="auto">-->
                                    <!--</video>-->
                                <!--</div>-->
                                <!--&lt;!&ndash;<div class="modal-body">&ndash;&gt;-->
                                <!--&lt;!&ndash;&lt;!&ndash;<p>编辑信息</p>&ndash;&gt;&ndash;&gt;-->
                                <!--&lt;!&ndash;<form>&ndash;&gt;-->
                                <!--&lt;!&ndash;用户名：<input v-model="bean_modify.name" name="name" class="form-control" placeholder="请输入用户名">&ndash;&gt;-->
                                <!--&lt;!&ndash;<br>&ndash;&gt;-->
                                <!--&lt;!&ndash;密&nbsp码：<input v-model="bean_modify.password" name="password" class="form-control"&ndash;&gt;-->
                                <!--&lt;!&ndash;placeholder="请输入密码">&ndash;&gt;-->
                                <!--&lt;!&ndash;<br>&ndash;&gt;-->
                                <!--&lt;!&ndash;修改图片：<input type="file" @change="getFile($event)"/>&ndash;&gt;-->
                                <!--&lt;!&ndash;&lt;!&ndash;<div align="center"><a href="#" @click="" >更新</a></div>&ndash;&gt;&ndash;&gt;-->

                                <!--&lt;!&ndash;&lt;!&ndash;<input type="submit" @click="update" value="更新">&ndash;&gt;&ndash;&gt;-->
                                <!--&lt;!&ndash;</form>&ndash;&gt;-->
                                <!--&lt;!&ndash;</div>&ndash;&gt;-->
                                <!--&lt;!&ndash;<div class="modal-footer">&ndash;&gt;-->
                                <!--&lt;!&ndash;<button data-dismiss="modal" class="btn btn-default" type="button">关闭</button>&ndash;&gt;-->
                                <!--&lt;!&ndash;<button data-dismiss="modal" class="btn btn-primary" type="button" @click="update">提交修改</button>&ndash;&gt;-->
                                <!--&lt;!&ndash;</div>&ndash;&gt;-->
                            <!--</div>&lt;!&ndash; /.modal-content &ndash;&gt;-->
                        <!--</div>&lt;!&ndash; /.modal-dialog &ndash;&gt;-->
                    <!--</div>-->
                </div>
                <!--栅栏布局9列结束-->


            </div>
        </div>
    </div>
</div>

</body>
</html>