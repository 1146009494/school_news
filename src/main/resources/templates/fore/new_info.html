<!DOCTYPE html>
<html lang="en">
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="'新闻详情'">首页</title>
    <script src="webjars/jquery/2.0.0/jquery.min.js"></script>
    <link href="webjars/bootstrap/3.0.1/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
<div id="workingArea" class="container">
    <div class="row  ">
        <!--布局div-->
        <!--<div style="margin-top: 60px"></div>-->

        <!--导航栏-->
        <div class="col-md-12 column">
            <!--顶部导航栏-->
            <nav class="navbar navbar-inverse " role="navigation">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse"
                            data-target="#bs-example-navbar-collapse-1"><span
                            class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span
                            class="icon-bar"></span><span class="icon-bar"></span></button>
                    <a class="navbar-brand" href="fore_home">小萝筐新闻网</a>
                </div>

                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <li v-for="type in types">
                            <a href="#" @click="search_type(type.name)">{{type.name}}</a>
                        </li>

                    </ul>
                    <form class="navbar-form navbar-left" role="search">
                        <div class="form-group">
                            <input type="text" class="form-control" v-model="keyword"/>
                        </div>
                        <button type="submit" class="btn btn-default" @click="search">搜索</button>
                    </form>
                    <!--右上角登陆模块-->
                    <ul class="nav navbar-nav navbar-right">
                        <li th:if="${null==session.user}">
                            <a href="fore_login">请登录</a>
                        </li>
                        <li class="dropdown" th:if="${null!=session.user}">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span
                                    th:text="${session.user.name}"></span><strong class="caret"></strong></a>
                            <ul class="dropdown-menu">
                                <li>
                                    <a href="home" @click="">个人中心</a>
                                </li>
                                <li>
                                    <a href="#" @click="logout">退出</a>
                                </li>
                                <!--<li>-->
                                <!--<a href="#">Something else here</a>-->
                                <!--</li>-->
                                <!--<li class="divider">-->
                                <!--</li>-->
                                <!--<li>-->
                                <!--<a href="#">Separated link</a>-->
                                <!--</li>-->
                            </ul>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
        <!--核心内容显示-->
        <div class="col-md-12 column">

            <!--网页展示-->
            <div class="row container ">
                <!--网页新闻展示列表右侧侧占4个栅格-->
                <div class="col-md-4 col-sm-4 col-xs-4 column " style="background-color: #D1CCC8;height: 400px;">
                    <br>
                    <hr>


                    <div class="col-md-4 col-sm-4 col-xs-4">
                        <img class="img-circle" height="50px" width="50px" :src="'img/user/'+bean.user_write.portrait">
                    </div>
                    <div class="col-md-4 col-sm-4 col-xs-4">
                        <h4><b>{{bean.user_write.realname}}</b></h4>
                    </div>
                    <div class="col-md-4 col-sm-4 col-xs-4"></div>
                    <br>
                    <br>

                    <hr>
                    <div class="col-md-3 col-sm-3 col-xs-3">
                        <h4 class="text-muted text-center">原创</h4>
                        <h4 class="text-muted text-center">4</h4>
                    </div>
                    <div class="col-md-3 col-sm-3 col-xs-3">
                        <h4 class="text-muted text-center">粉丝</h4>
                        <h4 class="text-muted text-center">20w</h4>
                    </div>
                    <div class="col-md-3 col-sm-3 col-xs-3">
                        <h4 class="text-muted text-center">喜欢</h4>
                        <h4 class="text-muted text-center">15</h4>
                    </div>
                    <div class="col-md-3 col-sm-3 col-xs-3-3">
                        <h4 class="text-muted text-center">评论</h4>
                        <h4 class="text-muted text-center">∞</h4>
                    </div>
                    <br>
                    <br>
                    <br>
                    <hr>

                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <div class="col-md-6 col-sm-6 col-xs-6">
                            <h4 class="text-muted text-center">等级</h4>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-6">
                            <h4 class="text-muted text-center">B</h4>
                        </div>
                    </div>
                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <div class="col-md-6 col-sm-6 col-xs-6">
                            <h4 class="text-muted text-center">访问</h4>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-6">
                            <h4 class="text-muted text-center">2273</h4>
                        </div>
                    </div>

                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <div class="col-md-6 col-sm-6 col-xs-6">
                            <h4 class="text-muted text-center">积分</h4>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-6">
                            <h4 class="text-muted text-center">105</h4>
                        </div>
                    </div>

                    <div class="col-md-6 col-sm-6 col-xs-6">
                        <div class="col-md-6 col-sm-6 col-xs-6">
                            <h4 class="text-muted text-center">排名</h4>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-6">
                            <h4 class="text-muted text-center">160w+</h4>
                        </div>
                    </div>


                </div>


                <!--网页新闻展示列表左侧占8个栅格-->
                <div class=" col-md-8 col-sm-8 col-xs-8 column">
                    <div class="col-md-offset-1 col-md-11 col-sm-11 col-xs-11" style="background-color: #D1CCC8;height:1000px">
                        <h3 class="text-center" >
                            <b>{{bean.note_title}}</b>
                        </h3>
                        <p style="width:100%">
                            <span v-html="bean.note" ></span>
                        </p>
                    </div>
                </div>
            </div>


        </div>
    </div>
</div>

<script src="webjars/bootstrap/3.0.1/js/bootstrap.min.js"></script>
<script src="js/vue/2.5.16/vue.min.js"></script>
<script src="js/axios/0.17.1/axios.min.js"></script>
<script src="js/moment/2.22.2/moment.js"></script> <!-- vue.js 格式化日期用的 -->
<script>
    /*公有模块*/
    //跳转函数
    function jump(page, vue) {
        if ('first' == page && !vue.pagination.first)
            vue.list(0);

        else if ('pre' == page && vue.pagination.hasPrevious)
            vue.list(vue.pagination.number - 1);

        else if ('next' == page && vue.pagination.hasNext)
            vue.list(vue.pagination.number + 1);

        else if ('last' == page && !vue.pagination.last)
            vue.list(vue.pagination.totalPages - 1);
    }

    //跳转函数
    function jumpByNumber(start, vue) {
        if (start != vue.pagination.number)
            vue.list(start);
    }
</script>
<script>
    /*时间格式化 全局过滤器*/
    Vue.filter('dateformat', function (dataStr) {
        return moment(dataStr).format('YYYY-MM-DD HH:mm:ss')
    });

    function getUrlParam(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
        var r = window.location.search.substr(1).match(reg);  //匹配目标参数
        if (r != null) return unescape(r[2]);
        return null; //返回参数值
    }

    $(function () {
        /*文档加载开始*/

        /*获取文章id*/
        var nid = Number(getUrlParam("nid"));


        var data4Vue = {
            uri: "new",
            pagination: {},
            beans: [],
            bean: {
                id: 0, user_write: {realname: ""}, refer_time: "", note_type: {id: 0}, note_title: "", note: ""
                , image_url: "", video_url: "", user_auditor: {realname: ""}, auditor_time: "", state: "审核通过"
            },
            state: "审核通过",
            types: [],
            is_search: "",
            keyword: "",
            size: "5",
        };

        //ViewModel
        var vue = new Vue({
            el: '#workingArea',
            data: data4Vue,
            mounted: function () { //mounted　表示这个 Vue 对象加载成功了
                /*初始化查询结果*/
                this.getNew();
                /*获取所有分类*/
                this.getNewType();
            },
            methods: {
                getNew: function () {
                    var url = this.uri + "/" + nid;
                    axios.get(url).then(function (response) {
                        console.log(response);
                        vue.bean = response.data.data;
                    })
                },
                getNewType: function () {
                    var url = "type";
                    axios.get(url).then(function (response) {
                        vue.types = response.data.data.content;
                        console.log(vue.types);
                    })
                },
                logout: function () {
                    var url = "logout";
                    axios.post(url).then(function (response) {
                        console.log(response.data);
                        if (response.data.code == 0) location.href = "fore_login";
                    });
                },
                /*搜索框的查询*/
                search: function () {
//                    alert(this.keyword);
                    this.is_search = true;
                    var url = this.uri + "_search/" + this.bean.state + "?keyword=" + this.keyword;
                    axios.get(url).then(function (response) {
                        vue.pagination = response.data.data;
                        vue.beans = response.data.data.content;
                    })
                },
                /*导航栏查询*/
                search_type: function (type_name) {
                    this.keyword = type_name;
                    this.search();
                },
                jump: function (page) {
                    jump(page, vue); //定义在adminHeader.html 中
                },
                jumpByNumber: function (start) {
                    jumpByNumber(start, vue);
                }
            }
        });

        /*文档加载结束*/
    });
</script>
</body>
</html>